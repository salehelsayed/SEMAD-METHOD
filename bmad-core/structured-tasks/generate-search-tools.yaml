id: generate-search-tools
name: Generate Search Tools
purpose: Extract keywords from PRD and generate search tool queries for comprehensive research. This task parses the Product Requirements Document to identify key technical terms and creates targeted search queries for various platforms and repositories.
inputs:
  prdPath:
    type: string
    description: Path to the PRD file (monolithic or sharded)
    default: docs/prd.md
  mappingsPath:
    type: string
    description: Path to tool mappings file
    default: bmad-core/data/tool-mappings.yaml
outputs:
  searchToolsFile:
    type: string
    description: Path to output search tools file
    default: search-tools.yaml
steps:
  - id: load-memory
    name: Load Memory and Initialize Context
    description: Load agent working memory and relevant long-term context using unified memory system
    actions:
      - description: Load agent working memory and relevant long-term context
        elicit: false
        function: loadMemoryForTask
        parameters:
          agentName: generic
          context:
            taskId: generate-search-tools
            taskType: content-creation
        metadata:
          memoryAction: true
          executionOrder: first
      - description: Apply memory context to task execution planning
        elicit: true
        metadata:
          memoryAction: true
          executionOrder: after-load
  - id: step0
    name: Initialize Memory and Context
    description: Set up working memory and retrieve relevant context
    actions:
      - description: Initialize working memory for search tools generation
        action: Execute task `update-working-memory` with agentName='sm' and taskId='generate-search-tools'
        elicit: false
      - description: Retrieve previous search patterns and keyword extraction methods
        action: Execute task `retrieve-context` with query='search tool generation patterns'
        elicit: false
  - id: parse-prd
    name: Parse PRD and Extract Keywords
    description: Run the keyword extraction script to generate search tools from PRD content
    actions:
      - description: Execute generate-search-tools.js script with provided inputs
        action: node scripts/generate-search-tools.js --prd {{inputs.prdPath}} --mappings {{inputs.mappingsPath}} --output {{outputs.searchToolsFile}}
        elicit: true
  - id: validate-output
    name: Validate Generated Search Tools
    description: Ensure the generated search tools file is valid YAML and contains expected structure
    actions:
      - description: Run validation script to verify file exists and has correct structure
        action: node scripts/validate-search-tools.js --file {{outputs.searchToolsFile}}
        elicit: true
  - id: save-memory
    name: Save Task Results and Clean Memory
    description: Save task completion and findings to memory with hygiene cleanup
    actions:
      - description: Save task completion and findings to working memory
        elicit: true
        function: saveAndCleanMemory
        parameters:
          agentName: generic
          taskData:
            observation: Completed generate-search-tools task successfully
            significantFinding: '{{TASK_SIGNIFICANT_FINDING}}'
            taskCompleted: true
            taskId: generate-search-tools
            context:
              taskType: content-creation
        metadata:
          memoryAction: true
          executionOrder: last
metadata:
  agent: sm
  priority: high
  estimated_hours: 0.5
  depends_on:
    - prd.md
  tags:
    - search
    - prd
    - extraction
